<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">

<!--Converted with LaTeX2HTML 2018 (Released Feb 1, 2018) -->
<HTML>
<HEAD>
<TITLE>WendzelNNTPd Version 2.1 Documentation</TITLE>
<META NAME="description" CONTENT="WendzelNNTPd Version 2.1 Documentation">
<META NAME="keywords" CONTENT="docs">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
<META NAME="Generator" CONTENT="LaTeX2HTML v2018">
<META HTTP-EQUIV="Content-Style-Type" CONTENT="text/css">

<LINK REL="STYLESHEET" HREF="docs.css">

</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<IMG WIDTH="81" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next_inactive" SRC="nx_grp_g.png"> 
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_g.png"> 
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev_g.png">   
<BR>
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<P>
<H1 ALIGN="CENTER">WendzelNNTPd Version 2.1 Documentation</H1>
<DIV CLASS="author_info">

<P ALIGN="CENTER"><STRONG>Steffen Wendzel, <TT><A NAME="tex2html1"
  HREF="https://www.wendzel.de">https://www.wendzel.de</A></TT></STRONG></P>
</DIV>

<P>

<BR>

<H2><A NAME="SECTION00100000000000000000">
Contents</A>
</H2>
<!--Table of Contents-->

<UL CLASS="TofC">
<LI><A NAME="tex2html69"
  HREF="docs.html#SECTION00200000000000000000">1 Introduction</A>
<UL>
<LI><A NAME="tex2html70"
  HREF="docs.html#SECTION00210000000000000000">1 Features</A>
<UL>
<LI><A NAME="tex2html71"
  HREF="docs.html#SECTION00211000000000000000">1 License</A>
<LI><A NAME="tex2html72"
  HREF="docs.html#SECTION00212000000000000000">2 Database Abstraction Layer</A>
<LI><A NAME="tex2html73"
  HREF="docs.html#SECTION00213000000000000000">3 Security</A>
<LI><A NAME="tex2html74"
  HREF="docs.html#SECTION00214000000000000000">4 Auto-prevention of double-postings</A>
<LI><A NAME="tex2html75"
  HREF="docs.html#SECTION00215000000000000000">5 IPv6</A>
<LI><A NAME="tex2html76"
  HREF="docs.html#SECTION00216000000000000000">6 Why this is not a perfect Usenet server</A>
</UL>
<LI><A NAME="tex2html77"
  HREF="docs.html#SECTION00220000000000000000">2 Contribute</A>
<LI><A NAME="tex2html78"
  HREF="docs.html#SECTION00230000000000000000">3 History</A>
</UL>
<BR>
<LI><A NAME="tex2html79"
  HREF="docs.html#SECTION00300000000000000000">2 Installation</A>
<UL>
<LI><A NAME="tex2html80"
  HREF="docs.html#SECTION00310000000000000000">1 Linux/*nix/BSD</A>
<UL>
<LI><A NAME="tex2html81"
  HREF="docs.html#SECTION00311000000000000000">1 Init Script for automatic Startup</A>
</UL>
<LI><A NAME="tex2html82"
  HREF="docs.html#SECTION00320000000000000000">2 Unofficial Note: Mac OS X</A>
<LI><A NAME="tex2html83"
  HREF="docs.html#SECTION00330000000000000000">3 Windows</A>
</UL>
<BR>
<LI><A NAME="tex2html84"
  HREF="docs.html#SECTION00400000000000000000">3 Configuration</A>
<UL>
<LI><A NAME="tex2html85"
  HREF="docs.html#SECTION00410000000000000000">1 Choosing a database engine</A>
<UL>
<LI><A NAME="tex2html86"
  HREF="docs.html#SECTION00411000000000000000">1 Modifying wendzelnntpd.conf</A>
<LI><A NAME="tex2html87"
  HREF="docs.html#SECTION00412000000000000000">2 Generating your database tables</A>
</UL>
<LI><A NAME="tex2html88"
  HREF="docs.html#SECTION00420000000000000000">2 Network Settings</A>
<LI><A NAME="tex2html89"
  HREF="docs.html#SECTION00430000000000000000">3 Setting the Allowed Size of Postings</A>
<LI><A NAME="tex2html90"
  HREF="docs.html#SECTION00440000000000000000">4 Verbose Mode</A>
<LI><A NAME="tex2html91"
  HREF="docs.html#SECTION00450000000000000000">5 Security Settings</A>
<UL>
<LI><A NAME="tex2html92"
  HREF="docs.html#SECTION00451000000000000000">1 Authentication and Access Control Lists (ACL)</A>
<LI><A NAME="tex2html93"
  HREF="docs.html#SECTION00452000000000000000">2 Anonymized Message-ID</A>
<LI><A NAME="tex2html94"
  HREF="docs.html#SECTION00453000000000000000">3 Changing the Default Salt for Password Hashing</A>
</UL>
</UL>
<BR>
<LI><A NAME="tex2html95"
  HREF="docs.html#SECTION00500000000000000000">4 Starting and Running WendzelNNTPd</A>
<UL>
<LI><A NAME="tex2html96"
  HREF="docs.html#SECTION00510000000000000000">1 Starting the Service</A>
<LI><A NAME="tex2html97"
  HREF="docs.html#SECTION00520000000000000000">2 Stopping and Restarting the Service</A>
<UL>
<LI><A NAME="tex2html98"
  HREF="docs.html#SECTION00521000000000000000">1 Automating Start, Stop, and Restart</A>
</UL>
<LI><A NAME="tex2html99"
  HREF="docs.html#SECTION00530000000000000000">3 Administration Tool `wendzelnntpadm'</A>
<LI><A NAME="tex2html100"
  HREF="docs.html#SECTION00540000000000000000">4 Creating/Listing/Deleting Newsgroups</A>
<UL>
<LI><A NAME="tex2html101"
  HREF="docs.html#SECTION00541000000000000000">1 Listing existing newsgroups</A>
<LI><A NAME="tex2html102"
  HREF="docs.html#SECTION00542000000000000000">2 Creating a new newsgroup</A>
<LI><A NAME="tex2html103"
  HREF="docs.html#SECTION00543000000000000000">3 Deleting a newsgroup</A>
</UL>
<LI><A NAME="tex2html104"
  HREF="docs.html#SECTION00550000000000000000">5 User Accounts Administration</A>
<UL>
<LI><A NAME="tex2html105"
  HREF="docs.html#SECTION00551000000000000000">1 Listing Users (and Passwords)</A>
<LI><A NAME="tex2html106"
  HREF="docs.html#SECTION00552000000000000000">2 Creating a new user</A>
<LI><A NAME="tex2html107"
  HREF="docs.html#SECTION00553000000000000000">3 Deleting an existing user</A>
</UL>
<LI><A NAME="tex2html108"
  HREF="docs.html#SECTION00560000000000000000">6 Access Control List Administration (just in case, when the standard NNTP authentication is not enough)</A>
<UL>
<LI><A NAME="tex2html109"
  HREF="docs.html#SECTION00561000000000000000">1 Invisible Newsgroups</A>
<LI><A NAME="tex2html110"
  HREF="docs.html#SECTION00562000000000000000">2 Simple Access Control</A>
<LI><A NAME="tex2html111"
  HREF="docs.html#SECTION00563000000000000000">3 Adding and Removing ACL Roles</A>
<LI><A NAME="tex2html112"
  HREF="docs.html#SECTION00564000000000000000">4 Connecting and Disconnecting Users with/from Roles</A>
<LI><A NAME="tex2html113"
  HREF="docs.html#SECTION00565000000000000000">5 Connecting and Disconnecting Roles with/from Newsgroups</A>
<LI><A NAME="tex2html114"
  HREF="docs.html#SECTION00566000000000000000">6 Listing your whole ACL configuration again</A>
</UL>
<LI><A NAME="tex2html115"
  HREF="docs.html#SECTION00570000000000000000">7 Hardening</A>
</UL>
<BR>
<LI><A NAME="tex2html116"
  HREF="docs.html#SECTION00600000000000000000">5 Upgrading</A>
<UL>
<LI><A NAME="tex2html117"
  HREF="docs.html#SECTION00610000000000000000">1 Upgrade from version 2.1.x to 2.1.y</A>
<LI><A NAME="tex2html118"
  HREF="docs.html#SECTION00620000000000000000">2 Upgrade from version 2.0.x to 2.1.y</A>
<LI><A NAME="tex2html119"
  HREF="docs.html#SECTION00630000000000000000">3 Upgrade from version 2.0.x to 2.0.y</A>
<LI><A NAME="tex2html120"
  HREF="docs.html#SECTION00640000000000000000">4 Upgrade from version 1.4.x to 2.0.x</A>
</UL>
<BR>
<LI><A NAME="tex2html121"
  HREF="docs.html#SECTION00700000000000000000">Index</A>
</UL>
<!--End of Table of Contents-->
<P>

<H1><A NAME="SECTION00200000000000000000"></A><A NAME="43"></A>
<BR>
<SPAN CLASS="arabic">1</SPAN> Introduction
</H1>

<P>
WendzelNNTPd is a tiny but easy to use Usenet server (NNTP server) for Linux, *nix and BSD. The server is written in C. For security reasons, it is compiled with stack smashing protection by default, if your compiler supports that feature.

<P>

<H1><A NAME="SECTION00210000000000000000">
<SPAN CLASS="arabic">1</SPAN> Features</A>
</H1>

<P>

<H2><A NAME="SECTION00211000000000000000">
<SPAN CLASS="arabic">1</SPAN> License</A>
</H2>

<P>
WendzelNNTPd uses the GPLv3 license.

<P>

<H2><A NAME="SECTION00212000000000000000">
<SPAN CLASS="arabic">2</SPAN> Database Abstraction Layer</A>
</H2>

<P>
WendzelNNTPd contains a database abstraction layer. Currently supported database systems are SQlite3 and MySQL. New databases can be easily added.

<P>

<H2><A NAME="SECTION00213000000000000000">
<SPAN CLASS="arabic">3</SPAN> Security</A>
</H2>

<P>
WendzelNNTPd contains different security features, the most important features are probably Access Control Lists (ACLs) and the Role Based Access Control (RBAC) system. ACL and RBAC are described in a own chapter. WendzelNNTPd was probably the first Usenet server with support for RBAC.

<P>
Another feature are so-called &ldquo;invisible newsgroups&rdquo;: If access control is activated, a user without permission to access the newsgroup will not be able to see the existence of the newsgroup. In case he knows about the existence of the newsgroup nevertheless, he will not be able to post to or read from the newsgroup.

<P>
However, <SPAN  CLASS="textbf">please note</SPAN> that the salting for password hashing is using SHA-256, but with a global user-definable salt that is concatenated with the username and password, rendering it less secure than using unique random hashes per password. Also, WendzelNNTPd does not support TLS (not even SSL)!

<P>

<H2><A NAME="SECTION00214000000000000000">
<SPAN CLASS="arabic">4</SPAN> Auto-prevention of double-postings</A>
</H2>

<P>
In case a user sends a post to two equal newsgroups within one post command's &ldquo;Newsgroups:&rdquo; header tag, the server will add it only once to save memory on the server and the time of the readers.

<P>

<H2><A NAME="SECTION00215000000000000000">
<SPAN CLASS="arabic">5</SPAN> IPv6</A>
</H2>

<P>
WendzelNNTPd supports IPv6. The server can listen on multiple IP addresses as well as multiple ports.

<P>

<H2><A NAME="SECTION00216000000000000000">
<SPAN CLASS="arabic">6</SPAN> Why this is not a perfect Usenet server</A>
</H2>

<P>
WendzelNNTPd does not implement all NNTP commands, but the (most) important ones. Another problem is that the regular expression library used is not 100% compatible with the NNTP matching in commands like &ldquo;XGTITLE&rdquo;. A 3rd aspect is that WendzelNNTPd cannot share messages with other NNTP servers. Finally, WendzelNNTPd lacks support for encrypted connections.

<P>

<H1><A NAME="SECTION00220000000000000000">
<SPAN CLASS="arabic">2</SPAN> Contribute</A>
</H1>

<P>
See the &ldquo;CONTRIBUTE&rdquo; file in the tarball.

<P>

<H1><A NAME="SECTION00230000000000000000">
<SPAN CLASS="arabic">3</SPAN> History</A>
</H1>

<P>
The project started in 2004 under the name Xyria:cdpNNTPd, as part of the Xyria project that also contained a fast DNS server, called Xyria:DNSd. In 2007, I renamed it to WendzelNNTPd and stopped development of Xyria:DNSd. Version 1.0.0 was released in 2007, version 2.0.0 in 2011. Since then I have primarily fixed reported bugs and added minor features to keep the software alive, which is also planned for the next ten years. A detailed history can be found in the &ldquo;HISTORY&rdquo; file in the tarball.

<P>

<H1><A NAME="SECTION00300000000000000000"></A><A NAME="97"></A>
<BR>
<SPAN CLASS="arabic">2</SPAN> Installation
</H1>

<P>
This chapter provides a guide on how to install WendzelNNTPd 2.x.

<P>

<H1><A NAME="SECTION00310000000000000000">
<SPAN CLASS="arabic">1</SPAN> Linux/*nix/BSD</A>
</H1>

<P>
To install WendzelNNTPd from source you need to download the provided archive file (e.g. wendzelnntpd-2.0.0.tar.gz) file.<A NAME="tex2html2"
  HREF="footnode.html#foot131"><SUP><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="footnote.png"></SUP></A> Extract it and run <SPAN  CLASS="textbf">./configure</SPAN>. Please note that configure indicates missing libraries and packages that you may first need to install using the package system of your operating system.

<P>
<PRE>
$ tar -xzf wendzelnntpd-2.0.0.tgz
$ cd wendzelnntpd
$ ./configure
...
</PRE>

<P>
<SPAN  CLASS="textbf">Please Note:</SPAN> <SPAN  CLASS="textit">If you wish to compile WITHOUT MySQL or WITHOUT SQlite support</SPAN>, then run <SPAN  CLASS="textbf">MYSQL=NO ./configure</SPAN> or <SPAN  CLASS="textbf">SQLITE=NO ./configure</SPAN>, respectively.

<P>
&nbsp;

<P>
<SPAN  CLASS="textbf">Please Note:</SPAN> <SPAN  CLASS="textit">For FreeBSD/OpenBSD/NetBSD/*BSD: There is no MySQL support; you need to use SQLite (i.e. run <TT>MYSQL=NO ./configure</TT>). Run <TT>configure</TT> as well as <TT>make</TT> in the <TT>bash</TT> shell (under some BSDs you first need to install <TT>bash</TT>).</SPAN>

<P>
&nbsp;

<P>
After <TT>configure</TT> has finished, run <SPAN  CLASS="textbf">make</SPAN>:

<P>
<PRE>
$ make
...
</PRE>

<P>
To install WendzelNNTPd on your system, you need superuser access. Run <SPAN  CLASS="textbf">make install</SPAN> to install it to the default location <SPAN  CLASS="textit">/usr/local/*</SPAN>.

<P>
<PRE>
$ sudo make install
</PRE>

<P>
<SPAN  CLASS="textbf">Please Note (Upgrades):</SPAN> Run <SPAN  CLASS="textbf">sudo make upgrade</SPAN> instead of <SPAN  CLASS="textbf">sudo make install</SPAN> for an upgrade. Please cf. Section&nbsp;<A HREF="#Ch:Upgrade"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>.

<P>
<SPAN  CLASS="textbf">Please Note (MySQL):</SPAN> <SPAN  CLASS="textit">If you plan to run MySQL</SPAN>, then no database was set up during 'make install'. Please refer to chapter 3 (configuration) to learn how to generate the MySQL database.

<P>

<H2><A NAME="SECTION00311000000000000000">
<SPAN CLASS="arabic">1</SPAN> Init Script for automatic Startup</A>
</H2>

<P>
There is a init script in the directory scripts/startup. It uses the usual parameters like &ldquo;start&rdquo;, &ldquo;stop&rdquo; and &ldquo;restart&rdquo;.

<P>

<H1><A NAME="SECTION00320000000000000000">
<SPAN CLASS="arabic">2</SPAN> Unofficial Note: Mac OS X</A>
</H1>

<P>
A user reported WendzelNNTPd-2.0.0 is installable under Mac OS X 10.5.8. The only necessary change was to add the flag &ldquo;-arch x86_64&rdquo; to compile the code on a 64 bit system. However, I never tried to compile WendzelNNTPd on a Mac.

<P>

<H1><A NAME="SECTION00330000000000000000">
<SPAN CLASS="arabic">3</SPAN> Windows</A>
</H1>

<P>
Not supported.

<P>

<H1><A NAME="SECTION00400000000000000000"></A><A NAME="178"></A>
<BR>
<SPAN CLASS="arabic">3</SPAN> Configuration
</H1>

<P>
This chapter will explain how to configure WendzelNNTPd after installation.

<P>
<SPAN  CLASS="textbf">Note:</SPAN> The configuration file for WendzelNNTPd is named <SPAN  CLASS="textit">/usr/local/etc/wendzelnntpd.conf</SPAN>. The format of the configuration file should be self-describing and the default config file includes many comments which will help you to understand the lines you can see and modify there.

<P>
<SPAN  CLASS="textbf">Note:</SPAN> On *nix-like operating systems the default installation path is <SPAN  CLASS="textit">/usr/local/*</SPAN> what means that the configuration file of WendzelNNTPd will be <SPAN  CLASS="textit">/usr/local/etc/wendzelnntpd.conf</SPAN>, and the binaries will be placed in <SPAN  CLASS="textit">/usr/local/sbin</SPAN>. 
<P>

<H1><A NAME="SECTION00410000000000000000">
<SPAN CLASS="arabic">1</SPAN> Choosing a database engine</A>
</H1>

<P>
The first and most important step is to choose a database engine. You can use either SQLite3 (what is the default case and easy to use, but not suitable for larger systems with many thousand postings) or MySQL (which is of course the better solution, but also a little bit more complicated to realize). By default, WendzelNNTPd is configured for SQLite3 and is ready to run. If you want to keep this setting, you do not have to read this section.

<P>

<H2><A NAME="SECTION00411000000000000000">
<SPAN CLASS="arabic">1</SPAN> Modifying wendzelnntpd.conf</A>
</H2>

<P>
In the configuration file you will find a line called <SPAN  CLASS="textbf">database-engine</SPAN>. You can choose to use either MySQL or SQLite as the backend storage system by appending either <SPAN  CLASS="textbf">sqlite</SPAN> or <SPAN  CLASS="textbf">mysql</SPAN>.

<P>
<PRE>
database-engine mysql
</PRE>

<P>
If you choose to use MySQL then you will also need to specify the user and password which WendzelNNTPd should use to connect to the MySQL server. If your server does not run on localhost or uses a non-default MySQL port then you will have to modify these values too.

<P>
<PRE>
; Your database hostname (not needed for sqlite3)
database-server 127.0.0.1

; the database connection port (not needed for sqlite3)
; Comment out to use the default port of your database engine
database-port 3306

; Server authentication (not needed for sqlite3)
database-username mysqluser
database-password supercoolpass
</PRE>

<P>

<H2><A NAME="SECTION00412000000000000000">
<SPAN CLASS="arabic">2</SPAN> Generating your database tables</A>
</H2>

<P>
Once you have chosen your database backend you will need to create the database and the required tables.

<P>

<H3><A NAME="SECTION00412100000000000000">
<SPAN CLASS="arabic">1</SPAN> SQLite</A>
</H3>

<P>
If you chose SQLite as your database backend then you can skip this step as running <SPAN  CLASS="textbf">make install</SPAN> does this for you.

<P>
<SPAN  CLASS="textbf">Note:</SPAN> The SQLite database file as well as the posting management files will be stored in <SPAN  CLASS="textit">/var/spool/news/wendzelnntpd/</SPAN>.

<P>

<H3><A NAME="SECTION00412200000000000000">
<SPAN CLASS="arabic">2</SPAN> MySQL</A>
</H3>

<P>
For MySQL, a SQL script file is included called <SPAN  CLASS="textit">mysql_db_struct.sql</SPAN>. It creates the WendzelNNTPd database as well as all the needed tables. Use the MySQL console tool to execute the script.

<P>
<PRE>
$ cd /path/to/your/extracted/wendzelnntpd-archive/
$ mysql -u YOUR-USER -p
Enter password:
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 48
Server version: 5.1.37-1ubuntu5.1 (Ubuntu)

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

mysql&gt; source mysql\_db\_struct.sql
...
mysql&gt; quit
Bye
</PRE>

<P>

<H1><A NAME="SECTION00420000000000000000">
<SPAN CLASS="arabic">2</SPAN> Network Settings</A>
</H1>

<P>
Now you should specify the IP addresse(s) (IPv4 or IPv6) for WendzelNNTPd to accept connections on and the TCP port (the default NNTP port is 119) to run on.

<P>
<PRE>
; You have to specify the port _before_ using the 'listen' command!
port	119
; network addresses to listen on
listen	127.0.0.1
listen	::1
listen	192.168.0.1
</PRE>

<P>
You <SPAN  CLASS="textit">could</SPAN> also use different ports for each IP address by placing a <SPAN  CLASS="textbf">port</SPAN> command right before each <SPAN  CLASS="textbf">listen</SPAN> command but this is not recommended.

<P>

<H1><A NAME="SECTION00430000000000000000">
<SPAN CLASS="arabic">3</SPAN> Setting the Allowed Size of Postings</A>
</H1>

<P>
To change the maximum size of a post to be sent to the server, change the variable <SPAN  CLASS="textbf">max-size-of-postings</SPAN>. The value must be set in Bytes and the default value is 20971520 (20 MBytes).

<P>
<PRE>
max-size-of-postings 20971520
</PRE>

<P>

<H1><A NAME="SECTION00440000000000000000">
<SPAN CLASS="arabic">4</SPAN> Verbose Mode</A>
</H1>

<P>
If you have any problems running WendzelNNTPd or if you simply want more information about what is happening, you can uncomment the <SPAN  CLASS="textbf">verbose-mode</SPAN> line.

<P>
<PRE>
; Uncomment 'verbose-mode' if you want to find errors or if you
; have problems with the logging subsystem. All log strings are
; written to stderr too, if verbose-mode is set. Additionally all
; commands sent by clients are written to stderr too (but not to
; logfile)
verbose-mode
</PRE>

<P>

<H1><A NAME="SECTION00450000000000000000">
<SPAN CLASS="arabic">5</SPAN> Security Settings</A>
</H1>

<P>
Please note that WendzelNNTPd does not support SSL/TLS!

<P>

<H2><A NAME="SECTION00451000000000000000">
<SPAN CLASS="arabic">1</SPAN> Authentication and Access Control Lists (ACL)</A>
</H2>

<P>
WendzelNNTPd contains an extensive access control subsystem. If you want to only allow authenticated users access to the server, you should uncomment <SPAN  CLASS="textbf">use-authentication</SPAN>. This gives every authenticated user access to each newsgroup.

<P>
<PRE>
; Activate authentication
use-authentication
</PRE>

<P>
If you need a slightly more advanced authentication system, you can activate Access Control Lists (ACL) by uncommenting <SPAN  CLASS="textbf">use-acl</SPAN>. This activates the support for Role-based ACL too.

<P>
<PRE>
; If you activated authentication, you can also activate access
; control lists (ACL)
use-acl
</PRE>

<P>

<H2><A NAME="SECTION00452000000000000000">
<SPAN CLASS="arabic">2</SPAN> Anonymized Message-ID</A>
</H2>

<P>
By default, WendzelNNTPd makes a user's hostname or IP address part of new message-IDs when a user sends a post using the NNTP POST command. If you do not want that, you can force WendzelNNTPd not to do so by uncommenting <SPAN  CLASS="textbf">enable-anonym-mids</SPAN>, which enables anonymized Message-IDs.

<P>
<PRE>
; This prevents that IPs or Hostnames will become part of the
; message ID generated by WendzelNNTPd what is the default case.
; Uncomment it to enable this feature.
enable-anonym-mids
</PRE>

<P>

<H2><A NAME="SECTION00453000000000000000">
<SPAN CLASS="arabic">3</SPAN> Changing the Default Salt for Password Hashing</A>
</H2>

<P>
When uncommenting the keyword <SPAN  CLASS="textbf">hash-salt</SPAN>, the default salt value that is used to enrich the password hashes can be changed. Please note that you have to define the salt <SPAN  CLASS="textit">before</SPAN> you set-up the first password since it will otherwise be stored as hashed with an old salt, rendering it unusable. For this reason, it is best to define your salt right after running <SPAN  CLASS="textbf">make install</SPAN>.

<P>
<PRE>
; This keyword defines a salt to be used in conjunction with the
; passwords to calculate the cryptographic hashes. The salt must
; be in the form [a-zA-Z0-9.:\/-_]+.
; ATTENTION: If you change the salt after passwords have been
; stored, they will be rendered invalid! If you comment out
; hash-salt, then the default hash salt defined in the source
; code will be used.
hash-salt 0.hG4//3baA-::_\
</PRE>

<P>
WendzelNNTPd applies the SHA-2 hash algorithm using a 256 bit hash value. Please also note that the final hash is calculated using a string that combines salt, username and password as an input to prevent password-identification attacks when an equal password is used by multiple users. However, utilizing the username is less secure than having a completely separate salt for every password.

<P>

<H1><A NAME="SECTION00500000000000000000"></A><A NAME="322"></A>
<BR>
<SPAN CLASS="arabic">4</SPAN> Starting and Running WendzelNNTPd
</H1>

<P>

<H1><A NAME="SECTION00510000000000000000"></A><A NAME="324"></A>
<BR>
<SPAN CLASS="arabic">1</SPAN> Starting the Service
</H1>

<P>
Once your WendzelNNTPd installation has been configured, you can run the server (in the default case you need superuser access to do that since this is required to bind WendzelNNTPd to the default NNTP port 119) by starting <SPAN  CLASS="textbf">/usr/local/sbin/wendzelnntpd</SPAN>.

<P>
<PRE>
$ /usr/local/sbin/wendzelnntpd 
WendzelNNTPd: version 2.0.7 'Berlin'  - (Oct
26 2015 14:10:20 #2544) is ready.
</PRE>

<P>
<SPAN  CLASS="textbf">Note (Daemon Mode):</SPAN> If you want to run WendzelNNTPd as a background daemon process on *nix-like operating systems, you should use the parameter <SPAN  CLASS="textbf">-d</SPAN>.

<P>

<H1><A NAME="SECTION00520000000000000000"></A><A NAME="331"></A><A NAME="332"></A>
<BR>
<SPAN CLASS="arabic">2</SPAN> Stopping and Restarting the Service
</H1>

<P>
The server can be stopped by killing its process:

<P>
<PRE>
$ pkill wendzelnntpd
</PRE>

<P>
The server has a handler for the kill signal that allows to safely shutdown using <SPAN  CLASS="textbf">pkill</SPAN> or <SPAN  CLASS="textbf">kill</SPAN>.

<P>
To restart the service, kill and start the service.

<P>

<H2><A NAME="SECTION00521000000000000000">
<SPAN CLASS="arabic">1</SPAN> Automating Start, Stop, and Restart</A>
</H2>

<P>
The script <SPAN  CLASS="textbf">init.d_script</SPAN> in the directory <SPAN  CLASS="textit">scripts/startup</SPAN> of the tarball can be used to start, restart, and stop WendzelNNTPd. It is a standard init.d script for Linux operating systems that can usually be copied to <SPAN  CLASS="textit">/etc/init.d</SPAN> (it must be executable).

<P>
<PRE>
$ cp scripts/startup/init.d_script /etc/init.d/wendzelnntpd
$ chmod +x /etc/init.d/wendzelnntpd
</PRE>

<P>
<SPAN  CLASS="textbf">Note:</SPAN> Please note that some operating systems use different directories than <SPAN  CLASS="textit">/etc/init.d</SPAN> or other startup script formats. In such cases, the script works nevertheless but should simply be installed to <SPAN  CLASS="textit">/usr/local/sbin</SPAN> instead.

<P>
To start, stop, and restart WendzelNNTPd, the following commands can be used afterwards:

<P>
<PRE>
$ /etc/init.d/wendzelnntpd start
Starting WendzelNNTPd ... done.
WendzelNNTPd: version 2.0.7 'Berlin'  - (Oct
26 2015 14:10:20 #2544) is ready.

$ /etc/init.d/wendzelnntpd restart
Stopping WendzelNNTPd ... done.
Starting WendzelNNTPd ... done.
WendzelNNTPd: version 2.0.7 'Berlin'  - (Oct
26 2015 14:10:20 #2544) is ready.

$ /etc/init.d/wendzelnntpd stop
Stopping WendzelNNTPd ... done.
</PRE>

<P>

<H1><A NAME="SECTION00530000000000000000">
<SPAN CLASS="arabic">3</SPAN> Administration Tool `wendzelnntpadm'</A>
</H1>

<P>
Use the command line tool <SPAN  CLASS="textbf">wendzelnntpadm</SPAN> to configure user, role and newsgroup settings of your WendzelNNTPd installation. To get an overview of supported commands, run &ldquo;wendzelnntpadm help&rdquo;:

<P>
<PRE>
$ wendzelnntpadm help
usage: wendzelnntpd &lt;command&gt; [parameters]
*** Newsgroup Administration:
 &lt;listgroups&gt;
 &lt;addgroup | modgroup&gt; &lt;newsgroup&gt; &lt;posting-allowed-flag (y/n)&gt;
 &lt;delgroup&gt; &lt;newsgroup&gt;
*** User Administration:
 &lt;listusers&gt;
 &lt;adduser&gt; &lt;username&gt; [&lt;password&gt;]
 &lt;deluser&gt; &lt;username&gt;
*** ACL (Access Control List) Administration:
 &lt;listacl&gt;
 &lt;addacluser | delacluser&gt; &lt;username&gt; &lt;newsgroup&gt;
 &lt;addaclrole | delaclrole&gt; &lt;role&gt;
 &lt;rolegroupconnect | rolegroupdisconnect&gt; &lt;role&gt; &lt;newsgroup&gt;
 &lt;roleuserconnect | roleuserdisconnect&gt; &lt;role&gt; &lt;username&gt;
</PRE>

<P>

<H1><A NAME="SECTION00540000000000000000">
<SPAN CLASS="arabic">4</SPAN> Creating/Listing/Deleting Newsgroups</A>
</H1>

<P>
You can either list, create or delete newsgroups using <SPAN  CLASS="textbf">wendzelnntpadm</SPAN>.

<P>

<H2><A NAME="SECTION00541000000000000000">
<SPAN CLASS="arabic">1</SPAN> Listing existing newsgroups</A>
</H2>

<P>
<PRE>
$ wendzelnntpadm listgroups
Newsgroup, Low-, High-Value, Posting-Flag
-----------------------------------------
alt.test 10 1 y
mgmt.talk 1 1 y
secret.project-x 20 1 y
done.
</PRE>

<P>

<H2><A NAME="SECTION00542000000000000000">
<SPAN CLASS="arabic">2</SPAN> Creating a new newsgroup</A>
</H2>

<P>
To create a new newsgroup run the following command:

<P>
<PRE>
$ wendzelnntpadm addgroup my.cool.group y
Newsgroup my.cool.group does not exist. Creating new group.
done.
</PRE>

<P>
You can also change the &ldquo;posting allowed&rdquo; flag of a newsgroup but this takes currently no effect since WendzelNNTPd handles all newsgroups as newsgroups with posting allowed.

<P>
<PRE>
$ wendzelnntpadm modgroup my.cool.group y
Newsgroup my.cool.group exists: okay.
done.
$ wendzelnntpadm modgroup my.cool.group n
Newsgroup my.cool.group exists: okay.
done.
</PRE>

<P>

<H2><A NAME="SECTION00543000000000000000">
<SPAN CLASS="arabic">3</SPAN> Deleting a newsgroup</A>
</H2>

<P>
<PRE>
$ wendzelnntpadm delgroup my.cool.group
Newsgroup my.cool.group exists: okay.
Clearing association class ... done
Clearing ACL associations of newsgroup my.cool.group... done
Clearing ACL role associations of newsgroup my.cool.group... done
Deleting newsgroup my.cool.group itself ... done
Cleanup: Deleting postings that do not belong to an existing newsgroup ... done
done.
</PRE>

<P>

<H1><A NAME="SECTION00550000000000000000">
<SPAN CLASS="arabic">5</SPAN> User Accounts Administration</A>
</H1>

<P>
The easiest way to give only some people access to your server is to create user accounts (please make sure you activated authentication in your configuration file). You can add, delete and list all users.

<P>

<H2><A NAME="SECTION00551000000000000000">
<SPAN CLASS="arabic">1</SPAN> Listing Users (and Passwords)</A>
</H2>

<P>
This command always prints the password of the user too.

<P>
<PRE>
$ wendzelnntpadm listusers
Username, Password
------------------
developer1, wegerhgrhtrthjtzj
developer2, erghnrehhnht
manager1, wegergergrhth
manager2, thnthnrothnht
swendzel, lalalegergreg
swendzel2, 94j5z5jh5th
swendzel3, lalalalala
swendzel4, wegwegwegwegweg
done.
</PRE>

<P>

<H2><A NAME="SECTION00552000000000000000">
<SPAN CLASS="arabic">2</SPAN> Creating a new user</A>
</H2>

<P>
You can either enter the password as additional parameter (useful for scripts that create users automatically) ...

<P>
<PRE>
$ wendzelnntpadm adduser UserName HisPassWord
User UserName does currently not exist: okay.
done.
</PRE>

<P>
... or you can type it using the prompt (in this case the input is shadowed):

<P>
<PRE>
$ wendzelnntpadm adduser UserName2
Enter new password for this user (max. 100 chars):
User UserName2 does currently not exist: okay.
done.
</PRE>

<P>
<SPAN  CLASS="textbf">Please Note:</SPAN> A password must include at least 8 characters and may not include more than 100 characters.

<P>

<H2><A NAME="SECTION00553000000000000000">
<SPAN CLASS="arabic">3</SPAN> Deleting an existing user</A>
</H2>

<P>
<PRE>
$ wendzelnntpadm deluser UserName2
User UserName2 exists: okay.
Clearing ACL associations of user UserName2... done
Clearing ACL role associations of user UserName2... done
Deleting user UserName2 from database ... done
done.
</PRE>

<P>

<H1><A NAME="SECTION00560000000000000000">
<SPAN CLASS="arabic">6</SPAN> Access Control List Administration (just in case, when the standard NNTP authentication is not enough)</A>
</H1>

<P>
Welcome to the advanced part of WendzelNNTPd. WendzelNNTPd includes a powerful role based access control system. You can either only use normal access control lists where you can configure which user will have access to which newsgroup. Or you can use the advanced role system: You can add users to roles (e.g. the user &ldquo;boss99&rdquo; to the role &ldquo;management&rdquo;) and give a role access to a group (e.g. role &ldquo;management&rdquo; shall have access to &ldquo;discuss.management&rdquo;).

<P>
<SPAN  CLASS="textbf">Note:</SPAN> Please note that you must activate the ACL feature in your configuration file to use it.

<P>
<SPAN  CLASS="textbf">Note:</SPAN> To see *ALL* data related to the ACL subsystem of your WendzelNNTPd installation, simply use &ldquo;wendzelnntpadm listacl&rdquo;.

<P>

<H2><A NAME="SECTION00561000000000000000">
<SPAN CLASS="arabic">1</SPAN> Invisible Newsgroups</A>
</H2>

<P>
WendzelNNTPd includes a feature called &ldquo;Invisible Newsgroups&rdquo; which means that a user without access to a newsgroup will neither see the newsgroup in the list of newsgroups, nor will he be able to post to such a newsgroup or will be able to read it.

<P>

<H2><A NAME="SECTION00562000000000000000">
<SPAN CLASS="arabic">2</SPAN> Simple Access Control</A>
</H2>

<P>
We should start with the simple access control where you can define which user should have access to which newsgroup.

<P>

<H3><A NAME="SECTION00562100000000000000">
<SPAN CLASS="arabic">1</SPAN> Giving a user access to a newsgroup</A>
</H3>

<P>
<PRE>
$ wendzelnntpadm addacluser swendzel alt.test
User swendzel exists: okay.
Newsgroup alt.test exists: okay.
done.
$ wendzelnntpadm listacl
List of roles in database:
Roles
-----

Connections between users and roles:
Role, User
----------

Username, Has access to group
-----------------------------
swendzel, alt.test

Role, Has access to group
-------------------------
done.
</PRE>

<P>

<H3><A NAME="SECTION00562200000000000000">
<SPAN CLASS="arabic">2</SPAN> Removing a user's access to a newsgroup</A>
</H3>

<P>
<PRE>
$ wendzelnntpadm delacluser swendzel alt.test
User swendzel exists: okay.
Newsgroup alt.test exists: okay.
done.
</PRE>

<P>

<H2><A NAME="SECTION00563000000000000000">
<SPAN CLASS="arabic">3</SPAN> Adding and Removing ACL Roles</A>
</H2>

<P>
If you have many users, some of them should have access to the same newsgroup (e.g. the developers of a new system should have access to the development newsgroup of the system). With roles you do not have to give every user explicit access to such a group. Instead you add the users to a role and give the role access to the group. (One advantage is that you can easily give the complete role access to another group with only one command instead of adding each of its users to the list of people who have access to the new group).

<P>
In the following examples, we give the users &ldquo;developer1&rdquo;, &ldquo;developer2&rdquo;, and &ldquo;developer3&rdquo; access to the development role of &ldquo;project-x&rdquo; and connect their role to the newsgroups &ldquo;project-x.discussion&rdquo; and &ldquo;project-x.support&rdquo;. To do so, we create the three users and the two newsgroups first:

<P>
<PRE>
$ wendzelnntpadm adduser developer1
Enter new password for this user (max. 100 chars):
User developer1 does currently not exist: okay.
done.
$ wendzelnntpadm adduser developer2
Enter new password for this user (max. 100 chars):
User developer2 does currently not exist: okay.
done.
$ wendzelnntpadm adduser developer3
Enter new password for this user (max. 100 chars):
User developer3 does currently not exist: okay.
done.

$ wendzelnntpadm addgroup project-x.discussion y
Newsgroup project-x.discussion does not exist. Creating new group.
done.
$ wendzelnntpadm addgroup project-x.support y
Newsgroup project-x.support does not exist. Creating new group.
done.
</PRE>

<P>

<H3><A NAME="SECTION00563100000000000000">
<SPAN CLASS="arabic">1</SPAN> Creating a Role</A>
</H3>

<P>
Before you can add users to a role and before you can connect a role to a newsgroup, you have to create a role (you have to choose an ASCII name for it). In this example, the group is called &ldquo;project-x&rdquo;.

<P>
<PRE>
$ wendzelnntpadm addaclrole project-x
Role project-x does not exists: okay.
done.
</PRE>

<P>

<H3><A NAME="SECTION00563200000000000000">
<SPAN CLASS="arabic">2</SPAN> Deleting a Role</A>
</H3>

<P>
You can delete a role by using &ldquo;delaclrole&rdquo; instead of &ldquo;addaclrole&rdquo; like in the example above.

<P>

<H2><A NAME="SECTION00564000000000000000">
<SPAN CLASS="arabic">4</SPAN> Connecting and Disconnecting Users with/from Roles</A>
</H2>

<P>
To add (connect) or remove (disconnect) a user to/from a role, you need to use the admin tool too.

<P>

<H3><A NAME="SECTION00564100000000000000">
<SPAN CLASS="arabic">1</SPAN> Connecting a User with a Role</A>
</H3>

<P>
The second parameter (&ldquo;project-x&rdquo;) is the role name and the third parameter (&ldquo;developer1&rdquo;) is the username. Here we add our 3 developer users from the example above to the group project-x:

<P>
<PRE>
$ wendzelnntpadm roleuserconnect project-x developer1
Role project-x exists: okay.
User developer1 exists: okay.
Connecting role project-x with user developer1 ... done
done.
$ wendzelnntpadm roleuserconnect project-x developer2
Role project-x exists: okay.
User developer2 exists: okay.
Connecting role project-x with user developer2 ... done
done.
$ wendzelnntpadm roleuserconnect project-x developer3
Role project-x exists: okay.
User developer3 exists: okay.
Connecting role project-x with user developer3 ... done
done.
</PRE>

<P>

<H3><A NAME="SECTION00564200000000000000">
<SPAN CLASS="arabic">2</SPAN> Disconnecting a User from a Role</A>
</H3>

<P>
<PRE>
$ wendzelnntpadm roleuserdisconnect project-x developer1
Role project-x exists: okay.
User developer1 exists: okay.
Dis-Connecting role project-x from user developer1 ... done
done.
</PRE>

<P>

<H2><A NAME="SECTION00565000000000000000">
<SPAN CLASS="arabic">5</SPAN> Connecting and Disconnecting Roles with/from Newsgroups</A>
</H2>

<P>
Even if a role is connected with a set of users, it is still useless until you connect the role with a newsgroup.

<P>

<H3><A NAME="SECTION00565100000000000000">
<SPAN CLASS="arabic">1</SPAN> Connecting a Role with a Newsgroup</A>
</H3>

<P>
To connect a role with a newsgroup, we have to use the command line tool for a last time (the 2nd parameter is the role, and the 3rd parameter is the name of the newsgroup). Here we connect our &ldquo;project-x&rdquo; role to the two newsgroups &ldquo;project-x.discussion&rdquo; and &ldquo;project-x.support&rdquo;:

<P>
<PRE>
$ wendzelnntpadm rolegroupconnect project-x project-x.discussion
Role project-x exists: okay.
Newsgroup project-x.discussion exists: okay.
Connecting role project-x with newsgroup project-x.discussion ... done
done.
$ wendzelnntpadm rolegroupconnect project-x project-x.support
Role project-x exists: okay.
Newsgroup project-x.support exists: okay.
Connecting role project-x with newsgroup project-x.support ... done
done.
</PRE>

<P>

<H3><A NAME="SECTION00565200000000000000">
<SPAN CLASS="arabic">2</SPAN> Disconnecting a Role from a Newsgroup</A>
</H3>

<P>
This is done like in the example above but you have to use the command &ldquo;rolegroup<SPAN  CLASS="textbf">dis</SPAN>connect&rdquo; instead of &ldquo;rolegroupconnect&rdquo;.

<P>

<H2><A NAME="SECTION00566000000000000000">
<SPAN CLASS="arabic">6</SPAN> Listing your whole ACL configuration again</A>
</H2>

<P>
Like mentioned before, you can use the command &ldquo;listacl&rdquo; to list your whole ACL configuration (except the list of users that will be listed by the command &ldquo;listusers&rdquo;).

<P>
<PRE>
$ wendzelnntpadm listacl
List of roles in database:
Roles
-----
project-x

Connections between users and roles:
Role, User
----------
project-x, developer1
project-x, developer2
project-x, developer3

Username, Has access to group
-----------------------------
swendzel, alt.test

Role, Has access to group
-------------------------
project-x, project-x.discussion
project-x, project-x.support
done.
</PRE>

<P>

<H3><A NAME="SECTION00566100000000000000">
<SPAN CLASS="arabic">1</SPAN> Saving time</A>
</H3>

<P>
As mentioned above, you as the maintainer of the usenet server can safe time by using roles. If you add a new developer to the system, and the developer should have access to the two groups &ldquo;project-x.discussion&rdquo; and &ldquo;project-x.support&rdquo;, you do not have to assign the user to both (or even more) groups. Instead, you just add the user to the role &ldquo;project-x&rdquo; that is already connected to both groups.

<P>
If you want to give all developers access to the group &ldquo;project-x.news&rdquo;, you also do not have to connect every developer with the project. Instead, you just connect the rule with the newsgroup, what is one command instead of <SPAN CLASS="MATH"><IMG
 WIDTH="15" HEIGHT="17" ALIGN="BOTTOM" BORDER="0"
 SRC="img1.png"
 ALT="$n$"></SPAN> commands. Of course, this time saving concept also works if you want to delete a user.

<P>

<H1><A NAME="SECTION00570000000000000000">
<SPAN CLASS="arabic">7</SPAN> Hardening</A>
</H1>

<P>
Besides the already mentioned authentication, ACL and RBAC features, the security of the server can be improved by putting WendzelNNTPd in a chroot environment or letting it run under an unprivileged user account (the user then needs write access to /var/spool/news/wendzelnntpd and read access to (/usr/local)/etc/wendzelnntpd.conf). An unprivileged user under Unix-like systems is also not able to create a listen socket on the default NNTP port (119) since all ports up to 1023 are reserved. This means that the server should use a port &gt;= 1024 if it is started by a non-root user. Note: Some Unix systems may have another privileged port configuration. 

<P>
Please also note that WendzelNNTPd can be easily identified due to its welcoming `banner' (desired code `200' message of NNTP). Tools such as <TT>nmap</TT> provide rules to identify WendzelNNTPd and its version this way. Theoretically, this could be changed by a slight code modification (welcome message, HELP output and other components that make the server identifiable). However, I do not recommend this as it is just a form of `security by obscurity'.

<H1><A NAME="SECTION00600000000000000000"></A><A NAME="590"></A><A NAME="Ch:Upgrade"></A>
<BR>
<SPAN CLASS="arabic">5</SPAN> Upgrading
</H1>

<P>

<H1><A NAME="SECTION00610000000000000000">
<SPAN CLASS="arabic">1</SPAN> Upgrade from version 2.1.x to 2.1.y</A>
</H1>

<P>
Same as upgrading from v.2.0.x to v.2.0.y, see Section <A HREF="#20xto20y"><IMG  ALIGN="BOTTOM" BORDER="1" ALT="[*]" SRC="crossref.png"></A>.

<P>
&nbsp;

<P>
&nbsp;

<P>

<H1><A NAME="SECTION00620000000000000000">
<SPAN CLASS="arabic">2</SPAN> Upgrade from version 2.0.x to 2.1.y</A>
</H1>

<P>
Please follow the upgrade instructions for upgrading from 2.0.x to 2.0.y below. However, once you use cryptographic hashes in your <SPAN  CLASS="textit">wendzelnntpd.conf</SPAN>, your previous passwords will not work anymore, i.e. you need to reset all passwords or deactivate the hashing feature.

<P>
&nbsp;

<P>
&nbsp;

<P>

<H1><A NAME="SECTION00630000000000000000"></A><A NAME="20xto20y"></A>
<BR>
<SPAN CLASS="arabic">3</SPAN> Upgrade from version 2.0.x to 2.0.y
</H1>

<P>
Stop WendzelNNTPd if it is currently running. Install WendzelNNTPd as described but run <SPAN  CLASS="textbf">make upgrade</SPAN> instead of <SPAN  CLASS="textbf">make install</SPAN>. Afterwards, start WendzelNNTPd again.

<P>
&nbsp;

<P>
&nbsp;

<P>

<H1><A NAME="SECTION00640000000000000000">
<SPAN CLASS="arabic">4</SPAN> Upgrade from version 1.4.x to 2.0.x</A>
</H1>

<P>
<SPAN  CLASS="textbf">Acknowledgement:</SPAN> I would like to thank Ann from Href.com for helping a lot with finding out how to upgrade from 1.4.x to 2.0.x!

<P>
&nbsp;

<P>
An upgrade from version 1.4.x was not foreseen due to the limited available time I have for the development. However, here is a dirty hack:

<P>

<H4><A NAME="SECTION00640010000000000000">
Preparation Step:</A>
</H4> You <SPAN  CLASS="textbf">need to create a backup of your existing installation first</SPAN>, at least everything from <SPAN  CLASS="textbf">/var/spool/news/wendzelnntpd</SPAN> as you will need all these files later. <SPAN  CLASS="textbf">Perform the following steps on your own risk - it is possible that they do not work on your system as only two WendzelNNTPd installations were tested!</SPAN>

<P>

<H4><A NAME="SECTION00640020000000000000">
First Step:</A>
</H4> Install Wendzelnntpd-2.x on a Linux system (Windows is not supported anymore). This requires some libraries and tools.

<P>
Under <SPAN  CLASS="textit">Ubuntu</SPAN> they all come as packages:
<PRE>
$ sudo apt-get install libmysqlclient-dev libsqlite3-dev flex bison sqlite3
</PRE>

<P>
Under <SPAN  CLASS="textit">CentOS</SPAN> they come as packages as well:
<PRE>
$ sudo yum install make gcc bison flex sqlite-devel
</PRE>

<P>
<SPAN  CLASS="textit">Other</SPAN> operating systems should provide the same or similar packages/ports.

<P>
Run <SPAN  CLASS="textbf">MYSQL=NO ./configure</SPAN>, followed by <SPAN  CLASS="textbf">make</SPAN>, and <SPAN  CLASS="textbf">sudo make install</SPAN>. This will compile, build and install WendzelNNTPd without MySQL support as you only rely on SQLite3 from v.1.4.x (and it would be significantly more difficult to bring the SQLite database content to a MySQL database).

<P>

<H4><A NAME="SECTION00640030000000000000">
Second Step:</A>
</H4> Please make sure WendzelNNTPd-2 is configured in a way that we can *hopefully* make it work with your own database file. Therefore, in the configuration file <SPAN  CLASS="textbf">/usr/local/etc/wendzelnntpd.conf</SPAN> make sure that WendzelNNTPd uses sqlite3 instead of mysql:

<P>
<PRE>
database-engine sqlite3
</PRE>

<P>

<H4><A NAME="SECTION00640040000000000000">
Third Step:</A>
</H4>
Now comes the tricky part. The install command should have created
<SPAN  CLASS="textbf">/var/spool/news/wendzelnntpd/usenet.db</SPAN>.
However, it is an empty usenet database file in the new format.
Now REPLACE that file with the file you use on your existing WendzelNNTPd installation, which uses the old 1.4.x format. Also copy all of your old <SPAN  CLASS="textbf">cdp*</SPAN> files and the old <SPAN  CLASS="textbf">nextmsgid</SPAN> file from your Windows system/from your backup directory to <SPAN  CLASS="textbf">/var/spool/news/wendzelnntpd/</SPAN>.

<P>
The following step is a very dirty hack but I hope it works for you. It is not 100% perfect as important table columns are then still of the type 'STRING' instead of the type 'TEXT'!

<P>
Load the sqlite3 tool with your replaced database file:

<P>
<PRE>
$ sudo sqlite3 /var/spool/news/wendzelnntpd/usenet.db
</PRE>

<P>
This will open the new file in editing mode. We now add the tables which are not part of v.1.4.x to your existing database file. Therefore enter the following commands:

<P>
<PRE>
CREATE TABLE roles (role TEXT PRIMARY KEY);
CREATE TABLE users2roles (username TEXT, role TEXT, PRIMARY KEY(username, role));
CREATE TABLE acl_users (username TEXT, ng TEXT, PRIMARY KEY(username, ng));
CREATE TABLE acl_roles (role TEXT, ng TEXT, PRIMARY KEY(role, ng));
.quit
</PRE>

<P>

<H4><A NAME="SECTION00640050000000000000">
Fix Postings</A>
</H4>

<P>
You will probably see no post bodies right now if posts are requested by your client. Therefore, switch into <SPAN  CLASS="textbf">/var/spool/news/wendzelnntpd</SPAN> and run (as superuser) this command, it will replace the broken trailings with corrected ones:

<P>
<PRE>
$ cd /var/spool/news/wendzelnntpd
$ for filn in `/bin/ls cdp*`; do echo $filn; cat $filn | \
sed 's/\.\r/.\r\n/' &gt; new;  num=`wc -l new| \
awk '{$minone=$1-1; print $minone}'` ; \
head -n $num new &gt; $filn; done
$
</PRE>

<P>

<H4><A NAME="SECTION00640060000000000000">
Last Step (Checking whether it works!):</A>
</H4>

<P>
First check, whether the database file is accepted at all:

<P>
<PRE>
$ sudo wendzelnntpadm listgroups
</PRE>

<P>
It should list all your newsgroups

<P>
<PRE>
$ sudo wendzelnntpadm listusers
</PRE>

<P>
It should list all existing users. Accordingly

<P>
<PRE>
$ sudo wendzelnntpadm listacl
</PRE>

<P>
should list all access control entries (which will be empty right now but if no error message appears, the related tables are now part of your database file!).

<P>
&nbsp;

<P>
Now start WendzelNNTPd via <SPAN  CLASS="textbf">sudo wendzelnntpd</SPAN> and try to connect with a NNTP client to your WendzelNNTPd and then try reading posts, sending new posts and replying to these posts.

<P>
If this works, you can now run v2.x on 32bit and 64bit Linux :) Congrats, you made it and chances are you are the second user who did that. Let me know via e-mail if it worked for you.

<P>

<BR>

<H2><A NAME="SECTION00700000000000000000">
Index</A>
</H2><DL COMPACT>
<DT><STRONG>Configuration</STRONG>
<DD><A HREF="docs.html#178"><SPAN CLASS="arabic">3</SPAN></A>
<DT><STRONG>Installation</STRONG>
<DD><A HREF="docs.html#97"><SPAN CLASS="arabic">2</SPAN></A>
<DT><STRONG>Introduction</STRONG>
<DD><A HREF="docs.html#43"><SPAN CLASS="arabic">1</SPAN></A>
<DT><STRONG>Restarting WendzelNNTPd</STRONG>
<DD><A HREF="docs.html#332"><SPAN CLASS="arabic">2</SPAN></A>
<DT><STRONG>Starting WendzelNNTPd</STRONG>
<DD><A HREF="docs.html#322"><SPAN CLASS="arabic">4</SPAN></A>
 | <A HREF="docs.html#324"><SPAN CLASS="arabic">1</SPAN></A>
<DT><STRONG>Stopping WendzelNNTPd</STRONG>
<DD><A HREF="docs.html#331"><SPAN CLASS="arabic">2</SPAN></A>
<DT><STRONG>Upgrade</STRONG>
<DD><A HREF="docs.html#590"><SPAN CLASS="arabic">5</SPAN></A>

</DL>

<P>

<H1><A NAME="SECTION00800000000000000000">
About this document ...</A>
</H1>
 <STRONG>WendzelNNTPd Version 2.1 Documentation</STRONG><P>
This document was generated using the
<A HREF="http://www.latex2html.org/"><STRONG>LaTeX</STRONG>2<tt>HTML</tt></A> translator Version 2018 (Released Feb 1, 2018)
<P>
Copyright &#169; 1993, 1994, 1995, 1996,
Nikos Drakos, 
Computer Based Learning Unit, University of Leeds.
<BR>
Copyright &#169; 1997, 1998, 1999,
<A HREF="http://www.maths.mq.edu.au/~ross/">Ross Moore</A>, 
Mathematics Department, Macquarie University, Sydney.
<P>
The command line arguments were: <BR>
 <STRONG>latex2html</STRONG> <TT>-show_section_numbers -local_icons -split 2 docs.tex</TT>
<P>
The translation was initiated on 2021-04-17
<BR><HR>
<!--Table of Child-Links-->
<A NAME="CHILD_LINKS"></A>

<UL CLASS="ChildLinks">
<LI><A NAME="tex2html3"
  HREF="docs.html#SECTION00100000000000000000">Contents</A>
<LI><A NAME="tex2html4"
  HREF="docs.html#SECTION00200000000000000000"><SPAN CLASS="arabic">1</SPAN> Introduction</A>
<UL>
<LI><A NAME="tex2html5"
  HREF="docs.html#SECTION00210000000000000000"><SPAN CLASS="arabic">1</SPAN> Features</A>
<UL>
<LI><A NAME="tex2html6"
  HREF="docs.html#SECTION00211000000000000000"><SPAN CLASS="arabic">1</SPAN> License</A>
<LI><A NAME="tex2html7"
  HREF="docs.html#SECTION00212000000000000000"><SPAN CLASS="arabic">2</SPAN> Database Abstraction Layer</A>
<LI><A NAME="tex2html8"
  HREF="docs.html#SECTION00213000000000000000"><SPAN CLASS="arabic">3</SPAN> Security</A>
<LI><A NAME="tex2html9"
  HREF="docs.html#SECTION00214000000000000000"><SPAN CLASS="arabic">4</SPAN> Auto-prevention of double-postings</A>
<LI><A NAME="tex2html10"
  HREF="docs.html#SECTION00215000000000000000"><SPAN CLASS="arabic">5</SPAN> IPv6</A>
<LI><A NAME="tex2html11"
  HREF="docs.html#SECTION00216000000000000000"><SPAN CLASS="arabic">6</SPAN> Why this is not a perfect Usenet server</A>
</UL>
<LI><A NAME="tex2html12"
  HREF="docs.html#SECTION00220000000000000000"><SPAN CLASS="arabic">2</SPAN> Contribute</A>
<LI><A NAME="tex2html13"
  HREF="docs.html#SECTION00230000000000000000"><SPAN CLASS="arabic">3</SPAN> History</A>
</UL>
<BR>
<LI><A NAME="tex2html14"
  HREF="docs.html#SECTION00300000000000000000"><SPAN CLASS="arabic">2</SPAN> Installation</A>
<UL>
<LI><A NAME="tex2html15"
  HREF="docs.html#SECTION00310000000000000000"><SPAN CLASS="arabic">1</SPAN> Linux/*nix/BSD</A>
<UL>
<LI><A NAME="tex2html16"
  HREF="docs.html#SECTION00311000000000000000"><SPAN CLASS="arabic">1</SPAN> Init Script for automatic Startup</A>
</UL>
<LI><A NAME="tex2html17"
  HREF="docs.html#SECTION00320000000000000000"><SPAN CLASS="arabic">2</SPAN> Unofficial Note: Mac OS X</A>
<LI><A NAME="tex2html18"
  HREF="docs.html#SECTION00330000000000000000"><SPAN CLASS="arabic">3</SPAN> Windows</A>
</UL>
<BR>
<LI><A NAME="tex2html19"
  HREF="docs.html#SECTION00400000000000000000"><SPAN CLASS="arabic">3</SPAN> Configuration</A>
<UL>
<LI><A NAME="tex2html20"
  HREF="docs.html#SECTION00410000000000000000"><SPAN CLASS="arabic">1</SPAN> Choosing a database engine</A>
<UL>
<LI><A NAME="tex2html21"
  HREF="docs.html#SECTION00411000000000000000"><SPAN CLASS="arabic">1</SPAN> Modifying wendzelnntpd.conf</A>
<LI><A NAME="tex2html22"
  HREF="docs.html#SECTION00412000000000000000"><SPAN CLASS="arabic">2</SPAN> Generating your database tables</A>
<UL>
<LI><A NAME="tex2html23"
  HREF="docs.html#SECTION00412100000000000000"><SPAN CLASS="arabic">1</SPAN> SQLite</A>
<LI><A NAME="tex2html24"
  HREF="docs.html#SECTION00412200000000000000"><SPAN CLASS="arabic">2</SPAN> MySQL</A>
</UL>
</UL>
<LI><A NAME="tex2html25"
  HREF="docs.html#SECTION00420000000000000000"><SPAN CLASS="arabic">2</SPAN> Network Settings</A>
<LI><A NAME="tex2html26"
  HREF="docs.html#SECTION00430000000000000000"><SPAN CLASS="arabic">3</SPAN> Setting the Allowed Size of Postings</A>
<LI><A NAME="tex2html27"
  HREF="docs.html#SECTION00440000000000000000"><SPAN CLASS="arabic">4</SPAN> Verbose Mode</A>
<LI><A NAME="tex2html28"
  HREF="docs.html#SECTION00450000000000000000"><SPAN CLASS="arabic">5</SPAN> Security Settings</A>
<UL>
<LI><A NAME="tex2html29"
  HREF="docs.html#SECTION00451000000000000000"><SPAN CLASS="arabic">1</SPAN> Authentication and Access Control Lists (ACL)</A>
<LI><A NAME="tex2html30"
  HREF="docs.html#SECTION00452000000000000000"><SPAN CLASS="arabic">2</SPAN> Anonymized Message-ID</A>
<LI><A NAME="tex2html31"
  HREF="docs.html#SECTION00453000000000000000"><SPAN CLASS="arabic">3</SPAN> Changing the Default Salt for Password Hashing</A>
</UL>
</UL>
<BR>
<LI><A NAME="tex2html32"
  HREF="docs.html#SECTION00500000000000000000"><SPAN CLASS="arabic">4</SPAN> Starting and Running WendzelNNTPd</A>
<UL>
<LI><A NAME="tex2html33"
  HREF="docs.html#SECTION00510000000000000000"><SPAN CLASS="arabic">1</SPAN> Starting the Service</A>
<LI><A NAME="tex2html34"
  HREF="docs.html#SECTION00520000000000000000"><SPAN CLASS="arabic">2</SPAN> Stopping and Restarting the Service</A>
<UL>
<LI><A NAME="tex2html35"
  HREF="docs.html#SECTION00521000000000000000"><SPAN CLASS="arabic">1</SPAN> Automating Start, Stop, and Restart</A>
</UL>
<LI><A NAME="tex2html36"
  HREF="docs.html#SECTION00530000000000000000"><SPAN CLASS="arabic">3</SPAN> Administration Tool `wendzelnntpadm'</A>
<LI><A NAME="tex2html37"
  HREF="docs.html#SECTION00540000000000000000"><SPAN CLASS="arabic">4</SPAN> Creating/Listing/Deleting Newsgroups</A>
<UL>
<LI><A NAME="tex2html38"
  HREF="docs.html#SECTION00541000000000000000"><SPAN CLASS="arabic">1</SPAN> Listing existing newsgroups</A>
<LI><A NAME="tex2html39"
  HREF="docs.html#SECTION00542000000000000000"><SPAN CLASS="arabic">2</SPAN> Creating a new newsgroup</A>
<LI><A NAME="tex2html40"
  HREF="docs.html#SECTION00543000000000000000"><SPAN CLASS="arabic">3</SPAN> Deleting a newsgroup</A>
</UL>
<LI><A NAME="tex2html41"
  HREF="docs.html#SECTION00550000000000000000"><SPAN CLASS="arabic">5</SPAN> User Accounts Administration</A>
<UL>
<LI><A NAME="tex2html42"
  HREF="docs.html#SECTION00551000000000000000"><SPAN CLASS="arabic">1</SPAN> Listing Users (and Passwords)</A>
<LI><A NAME="tex2html43"
  HREF="docs.html#SECTION00552000000000000000"><SPAN CLASS="arabic">2</SPAN> Creating a new user</A>
<LI><A NAME="tex2html44"
  HREF="docs.html#SECTION00553000000000000000"><SPAN CLASS="arabic">3</SPAN> Deleting an existing user</A>
</UL>
<LI><A NAME="tex2html45"
  HREF="docs.html#SECTION00560000000000000000"><SPAN CLASS="arabic">6</SPAN> Access Control List Administration (just in case, when the standard NNTP authentication is not enough)</A>
<UL>
<LI><A NAME="tex2html46"
  HREF="docs.html#SECTION00561000000000000000"><SPAN CLASS="arabic">1</SPAN> Invisible Newsgroups</A>
<LI><A NAME="tex2html47"
  HREF="docs.html#SECTION00562000000000000000"><SPAN CLASS="arabic">2</SPAN> Simple Access Control</A>
<UL>
<LI><A NAME="tex2html48"
  HREF="docs.html#SECTION00562100000000000000"><SPAN CLASS="arabic">1</SPAN> Giving a user access to a newsgroup</A>
<LI><A NAME="tex2html49"
  HREF="docs.html#SECTION00562200000000000000"><SPAN CLASS="arabic">2</SPAN> Removing a user's access to a newsgroup</A>
</UL>
<LI><A NAME="tex2html50"
  HREF="docs.html#SECTION00563000000000000000"><SPAN CLASS="arabic">3</SPAN> Adding and Removing ACL Roles</A>
<UL>
<LI><A NAME="tex2html51"
  HREF="docs.html#SECTION00563100000000000000"><SPAN CLASS="arabic">1</SPAN> Creating a Role</A>
<LI><A NAME="tex2html52"
  HREF="docs.html#SECTION00563200000000000000"><SPAN CLASS="arabic">2</SPAN> Deleting a Role</A>
</UL>
<LI><A NAME="tex2html53"
  HREF="docs.html#SECTION00564000000000000000"><SPAN CLASS="arabic">4</SPAN> Connecting and Disconnecting Users with/from Roles</A>
<UL>
<LI><A NAME="tex2html54"
  HREF="docs.html#SECTION00564100000000000000"><SPAN CLASS="arabic">1</SPAN> Connecting a User with a Role</A>
<LI><A NAME="tex2html55"
  HREF="docs.html#SECTION00564200000000000000"><SPAN CLASS="arabic">2</SPAN> Disconnecting a User from a Role</A>
</UL>
<LI><A NAME="tex2html56"
  HREF="docs.html#SECTION00565000000000000000"><SPAN CLASS="arabic">5</SPAN> Connecting and Disconnecting Roles with/from Newsgroups</A>
<UL>
<LI><A NAME="tex2html57"
  HREF="docs.html#SECTION00565100000000000000"><SPAN CLASS="arabic">1</SPAN> Connecting a Role with a Newsgroup</A>
<LI><A NAME="tex2html58"
  HREF="docs.html#SECTION00565200000000000000"><SPAN CLASS="arabic">2</SPAN> Disconnecting a Role from a Newsgroup</A>
</UL>
<LI><A NAME="tex2html59"
  HREF="docs.html#SECTION00566000000000000000"><SPAN CLASS="arabic">6</SPAN> Listing your whole ACL configuration again</A>
<UL>
<LI><A NAME="tex2html60"
  HREF="docs.html#SECTION00566100000000000000"><SPAN CLASS="arabic">1</SPAN> Saving time</A>
</UL>
</UL>
<LI><A NAME="tex2html61"
  HREF="docs.html#SECTION00570000000000000000"><SPAN CLASS="arabic">7</SPAN> Hardening</A>
</UL>
<BR>
<LI><A NAME="tex2html62"
  HREF="docs.html#SECTION00600000000000000000"><SPAN CLASS="arabic">5</SPAN> Upgrading</A>
<UL>
<LI><A NAME="tex2html63"
  HREF="docs.html#SECTION00610000000000000000"><SPAN CLASS="arabic">1</SPAN> Upgrade from version 2.1.x to 2.1.y</A>
<LI><A NAME="tex2html64"
  HREF="docs.html#SECTION00620000000000000000"><SPAN CLASS="arabic">2</SPAN> Upgrade from version 2.0.x to 2.1.y</A>
<LI><A NAME="tex2html65"
  HREF="docs.html#SECTION00630000000000000000"><SPAN CLASS="arabic">3</SPAN> Upgrade from version 2.0.x to 2.0.y</A>
<LI><A NAME="tex2html66"
  HREF="docs.html#SECTION00640000000000000000"><SPAN CLASS="arabic">4</SPAN> Upgrade from version 1.4.x to 2.0.x</A>
</UL>
<BR>
<LI><A NAME="tex2html67"
  HREF="docs.html#SECTION00700000000000000000">Index</A>
<LI><A NAME="tex2html68"
  HREF="docs.html#SECTION00800000000000000000">About this document ...</A>
</UL>
<!--End of Table of Child-Links-->

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<IMG WIDTH="81" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="next_inactive" SRC="nx_grp_g.png"> 
<IMG WIDTH="26" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="up" SRC="up_g.png"> 
<IMG WIDTH="63" HEIGHT="24" ALIGN="BOTTOM" BORDER="0" ALT="previous" SRC="prev_g.png">   
<BR></DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
