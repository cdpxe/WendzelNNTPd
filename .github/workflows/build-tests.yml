name: Build tests

on:
    workflow_dispatch:
    push:
        branches:

jobs:
# Plan:
# Setup qemu mit docker/setup-qemu-action@v3
# docker run und da drin dann dependencies installieren, dann ./configure && make && make install und dann config bereitstellen, tls-cert erstellen und wendzelnntpd starten
# expect und tcl installieren oder das passende Docker-image verwenden und dann die Tests starten
  build-test:
    runs-on: ubuntu-latest
    name: Build and Test wendzelnntpd
    steps:
      - uses: actions/checkout@v4
      - name: Set up QEMU
        uses: docker/setup-qemu-action@v3
        with:
          platforms: linux/riscv64
      - name: Install test tools
        run: apt-get update && apt-get install -y netcat-openbsd
      - name: Start Docker container
        run: |
          docker run \
            --rm \
            -v $(pwd):/${{ github.workspace }} \
            -w ${{ github.workspace }} \
#            --platform linux/riscv64 \
            --name testcontainer
            -d -it \
            debian:stable-slim \
            /bin/sh
      - name: Stop Docker container
        run: docker stop testcontainer -t 1
